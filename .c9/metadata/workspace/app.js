{"filter":false,"title":"app.js","tooltip":"/app.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":98,"column":31},"end":{"row":98,"column":39}},"text":"/path/to"},{"action":"insertText","range":{"start":{"row":98,"column":31},"end":{"row":98,"column":41}},"text":"./uploads/"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":98,"column":41},"end":{"row":98,"column":42}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":98,"column":52},"end":{"row":98,"column":53}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":99,"column":13},"end":{"row":99,"column":14}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":98,"column":8},"end":{"row":98,"column":9}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":98,"column":8},"end":{"row":98,"column":9}},"text":"("}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":98,"column":51},"end":{"row":98,"column":52}},"text":")"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":99,"column":8},"end":{"row":99,"column":9}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":99,"column":8},"end":{"row":99,"column":9}},"text":"("}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":99,"column":12},"end":{"row":99,"column":13}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":99,"column":12},"end":{"row":99,"column":13}},"text":")"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":99,"column":0},"end":{"row":99,"column":15}},"text":"doc.pipe(res); "},{"action":"removeLines","range":{"start":{"row":98,"column":0},"end":{"row":99,"column":0}},"nl":"\n","lines":["doc.pipe(fs.createWriteStream('./uploads/file.pdf')) ;"]}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":132,"column":10},"end":{"row":133,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":133,"column":0},"end":{"row":133,"column":54}},"text":"doc.pipe(fs.createWriteStream('./uploads/file.pdf')) ;"},{"action":"insertText","range":{"start":{"row":133,"column":54},"end":{"row":134,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":134,"column":0},"end":{"row":134,"column":15}},"text":"doc.pipe(res); "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":127,"column":32},"end":{"row":128,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":133,"column":0},"end":{"row":133,"column":15}},"text":"doc.pipe(res); "},{"action":"removeLines","range":{"start":{"row":132,"column":0},"end":{"row":133,"column":0}},"nl":"\n","lines":["doc.pipe(fs.createWriteStream('./uploads/file.pdf')) ;"]}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":98,"column":3},"end":{"row":98,"column":57}},"text":"doc.pipe(fs.createWriteStream('./uploads/file.pdf')) ;"},{"action":"insertText","range":{"start":{"row":98,"column":57},"end":{"row":99,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":99,"column":0},"end":{"row":99,"column":15}},"text":"doc.pipe(res); "}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":0,"column":0},"end":{"row":138,"column":0}},"nl":"\n","lines":["var express = require(\"express\"),","    app = express(),","    mongoose = require('mongoose'),","    db = mongoose.connection,","    request = require(\"request\"),","    multer = require('multer'),","    bodyParser = require('body-parser'),","    PDFDocument = require('pdfkit'),","    fs = require('fs');","    ","//Use for upload file","app.use(multer({","    dest: './uploads/'","}));","//use for parsing body data","app.use(bodyParser.urlencoded({","    extended: true","}));","app.use(bodyParser.json());","","","//add support for text/plain","app.use(function(req, res, next) {","    if (req.is('text/*')) {","        req.text = '';","        req.setEncoding('utf8');","        req.on('data', function(chunk) {","            req.text += chunk;","        });","        req.on('end', next);","    }","    else {","        next();","    }","});","app.listen(process.env.PORT, process.env.IP);","","//Start Mongoose","mongoose.connect(process.env.MONGOCON);","//DB open function","db.on('error', console.error.bind(console, 'mongodb connection error:'));","db.once('open', function callback() {","    console.log(\"DB Open\");","    //use to get the hl7 from mirth","    app.post('/posthl7', function(req, res) {","        console.log(req.text);","        res.send(200);","    });","    //use to post the file in body and the patient info in the header and forward it to mirth","    app.post('/postcr', function(req, res) {","        // console.log(req.files);","        // Forward to mirth","        console.log(req.headers.exam_infos);","","        request.post({","            url: 'http://146.148.3.248:80/crtxt/',","            body: req.headers.exam_infos,","            headers: {","                'Content-Type': 'text/plain'","            }","        }, function (error, response, body) {","    //HERE code to manage post errors","    });","        res.send(200);","    });","    ","    app.get('/hello', function(req, res) {","        //set the download name","        res.setHeader('Content-disposition', 'attachment; filename=dramaticpenguin.txt');","        // Send the datas ad a file","        ","    });","    ","    //use to receive the HL7 prescription and forward it to mirth","    app.post('/postprescriptionhl7', function(req, res) {","        //forward to mirth","        request.post({","            url: 'http://146.148.3.248:81/prescription/',","            body: req.text,","            headers: {","                'Content-Type': 'text/plain; charset=UTF-8'","            }","        });","        res.send(200);","    });","    //used to receive the TXT prescription from mirth","    app.post('/postprescriptiontxt', function(req, res) {","        console.log(req.body);","        // Need to escape \" in mirth in case","        res.send(200);","        // create PDF a document","        var  patientgender;","        if(req.body.PatientSex==\"M\"){","            patientgender=\"M.\";","        }else if (req.body.PatientSex==\"F\"){","            patientgender=\"Mme.\";","        }","var doc = new PDFDocument();","   doc.pipe(fs.createWriteStream('./uploads/file.pdf')) ;","doc.pipe(res);                                   ","doc.fontSize(14)",".text(req.body.SendingFacility)",".fontSize(10)",".text(req.body.FacilityStreetAdress)",".text(req.body.FacilityPostalCode+\" \"+req.body.FacilityCity)",".text(req.body.FacilityPhoneNumber)",".text('————————————————')",".fontSize(14)",".text('Dr '+req.body.DoctorFname+\" \"+req.body.DoctorLname)",".fontSize(10)",".text('N° RPPS : '+ req.body.DoctorRPPS)",".fontSize(18)",".text(patientgender+\" \"+req.body.PatientFname+\" \"+req.body.PatientLname, { align: 'right'})",".fontSize(12)",".text('Né(e) le '+ req.body.PatientDOB, {align: 'right'})",".text(req.body.Facility+\" - Chambre \"+req.body.PatientRoom, { align: 'right'})",".text('Séjour n° '+ req.body.PatientVisitNumber, { align: 'right'})",".fontSize(10)",".moveDown()",".text(req.body.PatientStreet, { align: 'right'})",".text(req.body.PatientPostalCode+\" \"+req.body.PatientCity, { align: 'right'})",".text(req.body.PatientPhone, { align: 'right'})",".moveDown(2)",".fontSize(12)",".text('Le, '+ req.body.PrescriptionDateTime)",".moveDown()",".fontSize(12)",".moveDown()",".text(req.body.PrescriptionText)",".moveDown(2)",".fontSize(8)",".text('Informations issues du logiciel '+ req.body.SendingAPP, { align: 'center'});","doc.end();","","    });","});","",""]},{"action":"insertText","range":{"start":{"row":0,"column":0},"end":{"row":0,"column":33}},"text":"var express = require(\"express\"),"},{"action":"insertText","range":{"start":{"row":0,"column":33},"end":{"row":1,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":1,"column":0},"end":{"row":122,"column":0}},"lines":["    app = express(),","    mongoose = require('mongoose'),","    db = mongoose.connection,","    request = require(\"request\"),","    multer = require('multer'),","    bodyParser = require('body-parser'),","    PDFDocument = require('pdfkit'),","    fs = require('fs');","","//Use for upload file","app.use(multer({","    dest: './uploads/'","}));","//use for parsing body data","app.use(bodyParser.urlencoded({","    extended: true","}));","app.use(bodyParser.json());","","","//add support for text/plain","app.use(function(req, res, next) {","    if (req.is('text/*')) {","        req.text = '';","        req.setEncoding('utf8');","        req.on('data', function(chunk) {","            req.text += chunk;","        });","        req.on('end', next);","    }","    else {","        next();","    }","});","app.listen(process.env.PORT, process.env.IP);","","//Start Mongoose","mongoose.connect(process.env.MONGOCON);","//DB open function","db.on('error', console.error.bind(console, 'mongodb connection error:'));","db.once('open', function callback() {","    console.log(\"DB Open\");","    //use to get the hl7 from mirth","    app.post('/posthl7', function(req, res) {","        console.log(req.text);","        res.send(200);","    });","    //use to post the file in body and the patient info in the header and forward it to mirth","    app.post('/postcr', function(req, res) {","        // console.log(req.files);","        // Forward to mirth","        console.log(req.headers.exam_infos);","","        request.post({","            url: 'http://146.148.3.248:80/crtxt/',","            body: req.headers.exam_infos,","            headers: {","                'Content-Type': 'text/plain'","            }","        }, function(error, response, body) {","            //HERE code to manage post errors","        });","        res.send(200);","    });","","    app.get('/hello', function(req, res) {","        //set the download name","        res.setHeader('Content-disposition', 'attachment; filename=dramaticpenguin.txt');","        // Send the datas ad a file","","    });","","    //use to receive the HL7 prescription and forward it to mirth","    app.post('/postprescriptionhl7', function(req, res) {","        //forward to mirth","        request.post({","            url: 'http://146.148.3.248:81/prescription/',","            body: req.text,","            headers: {","                'Content-Type': 'text/plain; charset=UTF-8'","            }","        });","        res.send(200);","    });","    //used to receive the TXT prescription from mirth","    app.post('/postprescriptiontxt', function(req, res) {","        console.log(req.body);","        // Need to escape \" in mirth in case","        res.send(200);","        // create PDF a document","        var patientgender;","        if (req.body.PatientSex == \"M\") {","            patientgender = \"M.\";","        }","        else if (req.body.PatientSex == \"F\") {","            patientgender = \"Mme.\";","        }","        var doc = new PDFDocument();","        doc.pipe(fs.createWriteStream('./uploads/file.pdf'));","        doc.pipe(res);","        doc.fontSize(14).text(req.body.SendingFacility).fontSize(10).text(req.body.FacilityStreetAdress).text(req.body.FacilityPostalCode + \" \" + req.body.FacilityCity).text(req.body.FacilityPhoneNumber).text('————————————————').fontSize(14).text('Dr ' + req.body.DoctorFname + \" \" + req.body.DoctorLname).fontSize(10).text('N° RPPS : ' + req.body.DoctorRPPS).fontSize(18).text(patientgender + \" \" + req.body.PatientFname + \" \" + req.body.PatientLname, {","            align: 'right'","        }).fontSize(12).text('Né(e) le ' + req.body.PatientDOB, {","            align: 'right'","        }).text(req.body.Facility + \" - Chambre \" + req.body.PatientRoom, {","            align: 'right'","        }).text('Séjour n° ' + req.body.PatientVisitNumber, {","            align: 'right'","        }).fontSize(10).moveDown().text(req.body.PatientStreet, {","            align: 'right'","        }).text(req.body.PatientPostalCode + \" \" + req.body.PatientCity, {","            align: 'right'","        }).text(req.body.PatientPhone, {","            align: 'right'","        }).moveDown(2).fontSize(12).text('Le, ' + req.body.PrescriptionDateTime).moveDown().fontSize(12).moveDown().text(req.body.PrescriptionText).moveDown(2).fontSize(8).text('Informations issues du logiciel ' + req.body.SendingAPP, {","            align: 'center'","        });","        doc.end();","","    });","});"]}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":8},"end":{"row":101,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":102,"column":8},"end":{"row":102,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":103,"column":8},"end":{"row":103,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":104,"column":8},"end":{"row":104,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":105,"column":8},"end":{"row":105,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":106,"column":8},"end":{"row":106,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":107,"column":8},"end":{"row":107,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":108,"column":8},"end":{"row":108,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":109,"column":8},"end":{"row":109,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":110,"column":8},"end":{"row":110,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":111,"column":8},"end":{"row":111,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":112,"column":8},"end":{"row":112,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":113,"column":8},"end":{"row":113,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":114,"column":8},"end":{"row":114,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":115,"column":8},"end":{"row":115,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":116,"column":8},"end":{"row":116,"column":11}},"text":"// "},{"action":"insertText","range":{"start":{"row":117,"column":8},"end":{"row":117,"column":11}},"text":"// "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":100,"column":22},"end":{"row":101,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":101,"column":0},"end":{"row":101,"column":8}},"text":"        "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":8},"end":{"row":101,"column":9}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":9},"end":{"row":101,"column":10}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":10},"end":{"row":101,"column":11}},"text":"c"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":11},"end":{"row":101,"column":12}},"text":"."}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":12},"end":{"row":101,"column":60}},"text":"fontSize(10).text(req.body.FacilityStreetAdress)"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":60},"end":{"row":101,"column":61}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":101,"column":30},"end":{"row":101,"column":59}},"text":"req.body.FacilityStreetAdress"},{"action":"insertText","range":{"start":{"row":101,"column":30},"end":{"row":101,"column":31}},"text":"\""}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":31},"end":{"row":101,"column":32}},"text":"H"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":32},"end":{"row":101,"column":33}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":33},"end":{"row":101,"column":34}},"text":"L"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":34},"end":{"row":101,"column":35}},"text":"L"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":35},"end":{"row":101,"column":36}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":101,"column":36},"end":{"row":101,"column":37}},"text":"\""}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":100,"column":0},"end":{"row":101,"column":0}},"nl":"\n","lines":["        doc.pipe(res);"]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":99,"column":8},"end":{"row":99,"column":61}},"text":"doc.pipe(fs.createWriteStream('./uploads/file.pdf'));"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":118,"column":18},"end":{"row":119,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":119,"column":0},"end":{"row":119,"column":8}},"text":"        "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":119,"column":8},"end":{"row":119,"column":61}},"text":"doc.pipe(fs.createWriteStream('./uploads/file.pdf'));"}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":100,"column":0},"end":{"row":101,"column":0}},"nl":"\n","lines":["        doc.fontSize(10).text(\"HELLO\");"]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":100,"column":8},"end":{"row":100,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":101,"column":8},"end":{"row":101,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":102,"column":8},"end":{"row":102,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":103,"column":8},"end":{"row":103,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":104,"column":8},"end":{"row":104,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":105,"column":8},"end":{"row":105,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":106,"column":8},"end":{"row":106,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":107,"column":8},"end":{"row":107,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":108,"column":8},"end":{"row":108,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":109,"column":8},"end":{"row":109,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":110,"column":8},"end":{"row":110,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":111,"column":8},"end":{"row":111,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":112,"column":8},"end":{"row":112,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":113,"column":8},"end":{"row":113,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":114,"column":8},"end":{"row":114,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":115,"column":8},"end":{"row":115,"column":11}},"text":"// "},{"action":"removeText","range":{"start":{"row":116,"column":8},"end":{"row":116,"column":11}},"text":"// "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":93,"column":33},"end":{"row":94,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":94,"column":0},"end":{"row":94,"column":12}},"text":"            "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":94,"column":12},"end":{"row":94,"column":13}},"text":"p"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":94,"column":13},"end":{"row":94,"column":14}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":94,"column":14},"end":{"row":94,"column":15}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":94,"column":15},"end":{"row":94,"column":16}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":94,"column":16},"end":{"row":94,"column":17}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":94,"column":17},"end":{"row":94,"column":18}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":94,"column":18},"end":{"row":94,"column":19}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":91,"column":25},"end":{"row":91,"column":26}},"text":","}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":91,"column":26},"end":{"row":92,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":92,"column":0},"end":{"row":92,"column":8}},"text":"        "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":8},"end":{"row":92,"column":9}},"text":"b"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":9},"end":{"row":92,"column":10}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":10},"end":{"row":92,"column":11}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":11},"end":{"row":92,"column":12}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":12},"end":{"row":92,"column":13}},"text":"g"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":13},"end":{"row":92,"column":14}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":14},"end":{"row":92,"column":15}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":15},"end":{"row":92,"column":16}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":16},"end":{"row":92,"column":17}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":92,"column":17},"end":{"row":92,"column":18}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":95,"column":12},"end":{"row":95,"column":19}},"text":"patient"},{"action":"insertText","range":{"start":{"row":95,"column":12},"end":{"row":95,"column":22}},"text":"borngender"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":95,"column":22},"end":{"row":95,"column":23}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":95,"column":23},"end":{"row":95,"column":24}},"text":"="}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":95,"column":24},"end":{"row":95,"column":25}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":95,"column":25},"end":{"row":95,"column":27}},"text":"\"\""}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":95,"column":26},"end":{"row":95,"column":27}},"text":"N"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":95,"column":27},"end":{"row":95,"column":28}},"text":"é"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":95,"column":29},"end":{"row":95,"column":30}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":98,"column":35},"end":{"row":99,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":99,"column":0},"end":{"row":99,"column":12}},"text":"            "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":99,"column":12},"end":{"row":99,"column":30}},"text":"borngender = \"Né\";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":99,"column":28},"end":{"row":99,"column":29}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":105,"column":29},"end":{"row":105,"column":35}},"text":"'Né(e)"},{"action":"insertText","range":{"start":{"row":105,"column":29},"end":{"row":105,"column":39}},"text":"borngender"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":105,"column":39},"end":{"row":105,"column":40}},"text":"+"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":105,"column":40},"end":{"row":105,"column":42}},"text":"\"\""}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":105,"column":41},"end":{"row":105,"column":42}},"text":"\""}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":105,"column":40},"end":{"row":105,"column":41}},"text":"\""}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":105,"column":40},"end":{"row":105,"column":42}},"text":"''"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":105,"column":41},"end":{"row":105,"column":42}},"text":"'"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":8,"column":22},"end":{"row":8,"column":23}},"text":","}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":8,"column":23},"end":{"row":9,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":9,"column":0},"end":{"row":9,"column":4}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":9,"column":4},"end":{"row":9,"column":27}},"text":"parser = require('L7');"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":9,"column":27},"end":{"row":9,"column":28}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":76,"column":26},"end":{"row":77,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":77,"column":0},"end":{"row":77,"column":8}},"text":"        "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":8},"end":{"row":77,"column":9}},"text":"c"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":9},"end":{"row":77,"column":10}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":10},"end":{"row":77,"column":11}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":11},"end":{"row":77,"column":12}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":12},"end":{"row":77,"column":13}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":13},"end":{"row":77,"column":14}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":14},"end":{"row":77,"column":15}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":15},"end":{"row":77,"column":16}},"text":"."}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":16},"end":{"row":77,"column":17}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":17},"end":{"row":77,"column":18}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":18},"end":{"row":77,"column":19}},"text":"g"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":19},"end":{"row":77,"column":21}},"text":"()"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":20},"end":{"row":77,"column":28}},"text":"req.text"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":77,"column":29},"end":{"row":77,"column":30}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":84,"column":0},"end":{"row":84,"column":11}},"text":"        });"},{"action":"removeLines","range":{"start":{"row":79,"column":0},"end":{"row":84,"column":0}},"nl":"\n","lines":["            url: 'http://146.148.3.248:81/prescription/',","            body: req.text,","            headers: {","                'Content-Type': 'text/plain; charset=UTF-8'","            }"]},{"action":"removeText","range":{"start":{"row":78,"column":7},"end":{"row":78,"column":22}},"text":" request.post({"},{"action":"removeText","range":{"start":{"row":78,"column":7},"end":{"row":79,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":78,"column":7},"end":{"row":78,"column":39}},"text":"var message = parser.parse(hl7);"},{"action":"insertText","range":{"start":{"row":78,"column":39},"end":{"row":79,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":79,"column":0},"end":{"row":81,"column":0}},"lines":["console.log(hl7);","console.log(message.query('PID|5[0]'));"]},{"action":"insertText","range":{"start":{"row":81,"column":0},"end":{"row":81,"column":39}},"text":"console.log(message.query('PID|5[1]'));"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":78,"column":34},"end":{"row":78,"column":37}},"text":"hl7"},{"action":"insertText","range":{"start":{"row":78,"column":34},"end":{"row":78,"column":42}},"text":"req.text"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":79,"column":0},"end":{"row":79,"column":17}},"text":"console.log(hl7);"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":78,"column":44},"end":{"row":79,"column":0}},"text":"\n"}]}]]},"ace":{"folds":[],"scrolltop":957,"scrollleft":0,"selection":{"start":{"row":88,"column":32},"end":{"row":88,"column":32},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":65,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1406668844957,"hash":"17b05d472355693f422d29844e7d1da210277238"}